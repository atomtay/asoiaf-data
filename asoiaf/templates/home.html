{% load staticfiles %}
<html>
    <head>
        <title>A Death by the Data</title>
        <!--[if lte IE 8]>
            <script src="{% static 'js/excanvas.js' %}"></script>
        <![endif]-->
        <link rel="stylesheet" href="{% static 'admin/css/base.css' %}">
        <link rel="stylesheet" href="{% static 'admin/css/asoiaf.css' %}">
        <link href="https://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet">
    </head>
    <body>
        <header>
            <h1>A Death by the Data</h1>
            <div class="fade"></div>
            <img src="https://cmzone-vzbqbxhynotw9ion96xv.netdna-ssl.com/wp-content/uploads/2017/07/Game-of-Thrones-season-8-wallpaper.jpg" class="head-image" style="width:100%;">
        </header>
        <main>
            <h2>Mortality by Gender: An Overview</h2>
            <table>
                <tr>
                    <td>
                        <canvas id="barchart" style="max-width:600px;"></canvas>
                    </td>
                    <td>
                        <blockquote style="font-size:20px; line-height: 24px; font-style:italic;">"She would die as she had lived, with an ax in her hand and a laugh upon her lips."
                        </blockquote>
                        <p style="font-size:16px;">Women make up for just under 18% of all named characters, but only 11% of listed deaths. Similar stats follow for chance of death: given these numbers, a named female character has a 1 in 5 chance of dying in the series, but a named male character has a little over a 1 in 3 chance.</p>
                        <p style="font-size:16px;">That said, there are significantly fewer female characters in this series, and this dataset only considers named characters (including one-off characters like Maerie Goodwife). Given how many presumably-male characters are slain in battle, these numbers are fairly conservative in the grand scheme.</p>
                    </td>
                </tr>
            </table>
            
            <h2>Death as a Literary Trope</h2>
            <table>
                <tr>
                    <td>
                        <canvas id="linechart"></canvas>
                    </td>

                    <td>
                        <blockquote style="font-size:20px; line-height: 24px; font-style:italic;">“'You're mine,' she whispered. 'Mine, as I'm yours. And if we die, we die. All men must die, Jon Snow. But first, we'll live.'”
                            </blockquote>
                       
                        <p style="font-size:16px;">Small sample size notwithstanding (is <i>The Winds of Winter</i> ever actually coming out?), so far it looks like women are more likely to die towards the end of the novels than men. On the other hand, the average chapter for a male character's death seems to be closer to the midpoint of each book.</p>

                        <p style="font-size:16px;">Granted, this all goes out the window in <i>A Clash of Kings</i>. I'd wager two silver stags that GRRM realized that maybe "The War of the Five Kings" included a few too many kings and quickly weeded out some of the stragglers.</p>

                    </td>
                </tr>
            </table>
        
            <h2>Who <i>really</i> plays the game?</h2>

            <table>
                <tr>
                    <td>
                        <canvas id="linechart2"></canvas>
                    </td>

                    <td>
                        <blockquote style="font-size:20px; line-height: 24px; font-style:italic;">“'Why is it always the innocents who suffer most, when you high lords play your game of thrones?'”
                        </blockquote>

                    </td>
                </tr>
            </table>

            <h2>Manner of death</h2>
            <table>
                <tr>
                    <td>
                        <canvas id="mannerofdeath"></canvas>
                    </td>

                    <td>
                        <blockquote style="font-size:20px; line-height: 24px; font-style:italic;">“'Why is it always the innocents who suffer most, when you high lords play your game of thrones?'”
                        </blockquote>

                    </td>
                </tr>
            </table>
        
        
        </main>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.2/Chart.min.js"></script>
    
        <script>
            fetch('{% url "overview_bar_chart_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("barchart").getContext("2d")
                new Chart(ctx, {
                    type: 'bar',
                    data: myJson
                });
            });

            fetch('{% url "chapter_line_chart_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("linechart").getContext("2d")
                new Chart(ctx, {
                    type: 'line', data: myJson
                });
            });

            fetch('{% url "manner_of_death_line_chart_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("mannerofdeath").getContext("2d")
                new Chart(ctx, {
                    type: 'bar', data: myJson, options:{
                   scales: {
                       xAxes: [{
                           display:true
                              }],
                       yAxes: [{
                           ticks: {
                               beginAtZero:true
                                   }
                               }]
                            }
                        }
                      });
            })

            fetch('{% url "new_line_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("linechart2").getContext("2d")
                new Chart(ctx, {
                    type: 'bar', data: myJson, options:{
                   scales: {
                       xAxes: [{
                           display:true
                              }],
                       yAxes: [{
                           ticks: {
                               beginAtZero:true
                                   }
                               }]
                            }
                        }
                      });
                });



            
        
        </script>
    </body>
</html>