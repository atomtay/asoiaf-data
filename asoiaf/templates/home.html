{% load staticfiles %}
<html>
    <head>
        <title>A Data Analysis of Thrones</title>
        <!--[if lte IE 8]>
            <script src="{% static 'js/excanvas.js' %}"></script>
        <![endif]-->
        <link rel="stylesheet" href="{% static 'admin/css/base.css' %}">
        <link rel="stylesheet" href="{% static 'admin/css/asoiaf.css' %}">
        <link href="https://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet">
    </head>
    <body>
        <header>
            <h1>A Death by the Data</h1>
            <div class="fade"></div>
            <img src="https://cmzone-vzbqbxhynotw9ion96xv.netdna-ssl.com/wp-content/uploads/2017/07/Game-of-Thrones-season-8-wallpaper.jpg" class="head-image" style="width:100%;">
        </header>
        <main>
            <h2>Mortality by Gender: An Overview</h2>
            <table>
                <tr>
                    <td>
                        <canvas id="barchart" style="max-width:600px;"></canvas>
                    </td>

                    <td>
                        <p>Women make up for just under 18% of all named characters, but only 11% of listed deaths.</p>

                    </td>
                </tr>
            </table>
            
            <h2>Death as a Literary Trope</h2>
            <table>
                <tr>
                    <td>
                        <canvas id="linechart"></canvas>
                    </td>

                    <td>
                        <p>Small sample size notwithstanding (is <i>The Winds of Winter</i> ever actually coming out?), so far it looks like women are more likely to die towards the end of the novels than men. On the other hand, the average chapter for a male character's death seems to be closer to the midpoint of each book.</p>

                    </td>
                </tr>
            </table>
        
            <h2>Test</h2>

            <table>
                <tr>
                    <td>
                        <canvas id="linechart2"></canvas>
                    </td>

                    <td>
                        <p>“The common people pray for rain, healthy children, and a summer that never ends," Ser Jorah told her. "It is no matter to them if the high lords play their game of thrones, so long as they are left in peace." He gave a shrug. "They never are.”</p>

                    </td>
                </tr>
            </table>
        
        
        </main>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.2/Chart.min.js"></script>
    
        <script>
            fetch('{% url "overview_bar_chart_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("barchart").getContext("2d")
                new Chart(ctx, {
                    type: 'bar',
                    data: myJson
                });
            });

            fetch('{% url "chapter_line_chart_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("linechart").getContext("2d")
                new Chart(ctx, {
                    type: 'line', data: myJson
                });
            });

            fetch('{% url "new_line_json" %}')
            .then(function(response) {
                return response.json();
            })
            .then(function(myJson) {
                console.log(JSON.stringify(myJson));
                const ctx = document.getElementById("linechart2").getContext("2d")
                new Chart(ctx, {
                    type: 'bar', data: myJson, options:{
                   scales: {
                       xAxes: [{
                           display:true
                              }],
                       yAxes: [{
                           ticks: {
                               beginAtZero:true
                                   }
                               }]
                            }
                        }
                      });
                });
            
        </script>
    </body>
</html>